# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

<h1 align="center">--Базовые компоненты--</h1>

<h3>Класс Component</h3>
Он является базовым компонентом и основой для многих других компонентов. Класс является дженериком и принимает в переменной  T  тип данных. 
Он реализует методы для работы с DOM элементами:
$${\color{lightgreen}toggleClass}$$ - переключение класса у элемента.
setText - установка текста в элемент.
setDisabled - установка или снятие атрибуда "disable" на элементе.
setImage - установка изображения с альтернативным текстом.
render - возвращает корневой дом элемент.
Является абстрактным классом.

<h3>Класс EventEmitter</h3>
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.
Класс имеет методы:
  on - для подписки на событие,
  off - отписки от события,
  emit - уведомления подписчиков о наступлении события. 
Дополнительно реализованы методы  onAll и  offAll  — для подписки на все события и сброса всех
подписчиков.
Интересным дополнением является метод  trigger , генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти
классы будут генерировать события, не будучи при этом напрямую зависимыми от класса  EventEmitter .

<h3>Класс Model</h3>
Данный класс нужен для того, чтобы можно было отличить модель от простых объектов с данными.
Реализует только один метод "emitChanges" (На основе метода "emit" класса EventEmitter) для сообщения всем слушателям об изменении даных в модели.

<h3>Класс Api</h3>
Базовый класс для создания fetch запросов на сервер и получения ответа.
Имеет один защищенный метод "handleResponse" для получения ответа от сервера и два общих "get" и "post" для получения и отправки данных соответственно.

<h1 align="center">-Компоненты модели данных-</h1>

<h3>Класс AppState</h3>
Данный класс наследует класс "Model" и отвечает за хранение и обработку всех данных приложения.
Класс содержит состояния Галлереи товаров, Корзины, Формы заказа и Валидации этой формы.
Реализует методы:
setCatalog - добавления готовых экземпляров с данными карточек товаров в галлерею,
setPreview - открытия опреденной карточки в модальном окне просмотра,
toggleBasketArticle - добавление или удаление товара из корзины,
getBasketArticles - получение списка товаров находящихся в корзине,
clearBasket - удаление всех товаров из корзины,
getTotal - получение общей стоимости всех товаров находящихся в корзине,
setOrderField - получение значений из полей формы заказа,
cleanInputs - отчистка полей формы для заказа,
cleanOrder - обнуление состояния заказа после успешной покупки,
и два метода валидации: "validateOrder" и "validateContacts" для валидации формы заказа и формы обратной связи.

<h3>Класс CatalogItem</h3>
Данный класс наследует класс "Model" и отвечает за хранение данных конкретного экземпляра товара.

<h3>Класс ShopAPI</h3>
Данный класс наследует класс "Api" и отвечает за получение данных с сервера. Нужен для удобного получения данных с сервера на основе методов из базового класса Api.
Класс имеет три метода:
getArticleList - получение массива карточек,
getArticleItem - получение отдельной карточки по её id,
orderArticles - отправка данных заказа и получение ответа от сервера.

<h1 align="center">- Коипоненты интерфейса и бизнесс логика-</h1>
Данные компоненты наследуют базовый класс "Component" и реализуют его методы.

<h3>Класс Modal</h3>
Выводит модальное окно с нужным наполнением, оно может закрываться как на кнопку так и по клику вне модального окна.

<h3>Класс Basket</h3>
Является наполнением для модального окна и показывает все товары, находящиеся в корзине. Отслеживает клик по кнопке открытия формы заказа.

<h3>Класс Page</h3>
Является контейнером для всего контента на странице, так же он отслеживает клик по кнопке корзины для открытия модального окна корзины.

<h3>Класс Article</h3>
В зависимости от полученных данных меняет: 
- цвет категории товара в зависимости от самой категории,
- цену товара, если цена не указана отображает текст "Бесценно",
- делает кнопку неактивной, если цена отсутствует.
Данный класс реализует три вида карточек, которые используются на странице: 
- Небольшая карточка для галлереи товаров (Отслеживает клик на себе для открытия модального окна большой карточки),
- Подробная карточка для отображения в модальном окне (Отслеживает клик по кнопке для добавления или удаления данного товара из корзины),
- Элемент списка товаров для использования внутри корзины (Отслеживает клик по кнопке для удаления данного товара из корзины).

<h3>Класс Form</h3>
Является базовым классом для отображения форм и отслеживает все поля конкретной формы для валидации и занесения полученных значений в заказ.

<h3>Класс Order и Contacts</h3>
Данные классы наследуются от класса "Form" и нужны для отображения в модальном окне шаблона формы. Если одно из полей не заполнено выводится ошибка с описанием, а кнопка блокируется. После того как все поля заполнены по нажатии на кнопку данные заказа отправляется на сервер и выводится окно успешного оформления заказа.

<h3>Класс Success</h3>
Отображает модальное окно успешного офрмления заказа с суммой заказа. При нажатии на кнопку сохраненные данные заказа в классе AppData обнуляются, корзина отчищается и модальное окно закрывается.

<h1 align="center">-Список событий-</h1>

`${"имя формы"}:submit` - событие отправки формы
`input.${имя поля ввода}:change` - событие ввода значений в форму
'payment:change' - измение способа оплаты в форме
'modal:open' - отрытие модального окна
'modal:close' - закрытие модального окна 
'items:changed' - изменение списка товаров в галлерее
'card:select' - карточка выбрана
'preview:changed' - изменение или открытие окна просмотра товара
'formErrors:change' - изменение ошибок формы
'order:open' - открытие формы заказа
'order:ready' - готовность формы
'basket:open' - открытие корзины
'card:editbasket' - добавление или удаление карточки из корзины внутри модального окна карточки
'basket:delete' - удаление карточки из корзины внутри модального окна корзины


